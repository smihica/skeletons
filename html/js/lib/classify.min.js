(function(window){function randomAscii(a){for(var b="";0<a;a--)b+=String.fromCharCode(32+Math.round(Math.random()*94));return b.replace(/'|"|\\/g,"@")}function ClassifyError(a){Error.apply(this,arguments),Error.captureStackTrace!==void 0&&Error.captureStackTrace(this,this.constructor),this.message=a}function createExceptionClass(a){var b=function(){ClassifyError.apply(this,arguments)};return b.prototype=new ClassifyError,b.prototype.name=a,b}function _atomic_p(a){var b;return a===null||a===void 0||(b=typeof a)==="number"||b==="string"||b==="boolean"||a.valueOf!==Object.prototype.valueOf&&!(a instanceof Date)}function _clone(a,b){if(_atomic_p(a))return a;var c,d;if(a instanceof Date){c=new Date(a.getTime());if(b instanceof Date)for(d in b)b.hasOwnProperty(d)&&(c[d]=_clone(b[d],c[d]))}else if(typeof a=="function"){c=function(){return a.apply(this,arguments)};if(typeof b=="function")for(d in b)b.hasOwnProperty(d)&&(c[d]=_clone(b[d],c[d]))}else c=!_atomic_p(b)&&typeof b!="function"?b:new a.constructor;for(d in a)a.hasOwnProperty(d)&&(c[d]=_clone(a[d],c[d]));return c}function __super__(){return this.constructor.__super__.prototype}function inherits(a,b){a.__super__=b;var c=function(){};c.prototype=b.prototype,c.prototype.constructor=b,a.prototype=new c,a.prototype.__super__=__super__;var d=a[init_instance_origin_props];return a[init_instance_origin_props]=function(a){var c=b[init_instance_origin_props];c&&c(a),d(a)},a}function method(a,b,c){c.__class__=a,a.prototype[b]=c}function mixin(a,b){var c=b.prototype;for(var d in c)d=="init"?a.prototype["init@"+b["@CLASSNAME"]]=c[d]:d!=="__super__"&&d!=="constructor"&&(a.prototype[d]=c[d]);var e=a[init_instance_origin_props];a[init_instance_origin_props]=function(a){var c=b[init_instance_origin_props];c&&c(a),e(a)}}function check_interface(a,b){for(var c in b.prototype)if(b.prototype.hasOwnProperty(c)&&!a.prototype.hasOwnProperty(c))throw new DeclarationError("The class '"+a["@CLASSNAME"]+"' must provide property or method '"+c+"' imposed by '"+b["@CLASSNAME"]+'".')}ClassifyError.prototype=Error();var NotImplemented=createExceptionClass("NotImplemented"),ValueError=createExceptionClass("ValueError"),PropertyError=createExceptionClass("PropertyError"),NotSupported=createExceptionClass("NotSupported"),NotAttached=createExceptionClass("NotAttached"),NotFound=createExceptionClass("NotFound"),AlreadyExists=createExceptionClass("AlreadyExists"),AssertionFailure=createExceptionClass("AssertionFailure"),ArgumentError=createExceptionClass("ArgumentError"),DeclarationError=createExceptionClass("DeclarationError"),genclassid=function(){var a=0;return function(){++a;var c="ANONYMOUS_CLASS_"+a;return c}}(),init_instance_origin_props=randomAscii(64),userModules={},classify=function classify(name,definition){if(name instanceof Object&&!name instanceof String&&definition===void 0)return classify(genclassid(),name);var __class__,i,j,l,c,def,type,context={property:{},"static":{},method:{},parent:Object,mixin:[],implement:[]},userModuleNames=[];for(var moduleName in userModules)userModuleNames.push(moduleName);for(i in definition)switch(i){case"property":def=definition[i];for(j in def)context.property[j]=def[j];break;case"static":context.static=definition[i];break;case"method":context.method=definition[i];break;case"parent":context.parent=definition[i];break;case"mixin":context.mixin=definition[i];break;case"implement":context.implement=definition[i];break;default:if(userModules[i])break;throw new ArgumentError("You gave '"+i+"' as definition, but the _class() excepts"+' only "property, method, static, parent, mixin, implement'+(0<userModuleNames.length?", "+userModuleNames.join(", "):"")+'".')}for(var moduleName in userModules){var def=null;if(def=definition[moduleName]){var fn=userModules[moduleName];for(var k in def)context=fn(context,k,def[k])}}var inner_new_call_identifier=randomAscii(64);eval("__class__ = function "+name+"(arg) {"+"if (this.constructor === "+name+") {"+name+"['"+init_instance_origin_props+"'](this);"+"if (arg !== '"+inner_new_call_identifier+"') "+("init"in context.method?"this.init.apply(this, arguments);":"_clone(arg, this);")+"return this;"+"}"+"var self = new "+name+"('"+inner_new_call_identifier+"');"+("init"in context.method?"self.init.apply(self, arguments);":"_clone(arg, self);")+"return self;"+"}"),__class__[init_instance_origin_props]=function(a){for(var b in context.property)a[b]=_clone(context.property[b])},inherits(__class__,context.parent);for(j=0,l=context.mixin.length;j<l;j++)mixin(__class__,context.mixin[j]);for(i in context.method)context.method.hasOwnProperty(i)&&method(__class__,i,context.method[i]);__class__.prototype.constructor=__class__,__class__["@CLASSNAME"]=name;for(j=0,l=context.implement.length;j<l;j++)check_interface(__class__,context.implement[j]);for(i in context.static)__class__[i]=context.static[i];return typeof context.static.init=="function"&&context.static.init.call(__class__),__class__};classify.module=function(a,b){userModules[a]=b},classify.error={ClassifyError:ClassifyError,NotImplemented:NotImplemented,ValueError:ValueError,PropertyError:PropertyError,NotSupported:NotSupported,NotAttached:NotAttached,NotFound:NotFound,AlreadyExists:AlreadyExists,AssertionFailure:AssertionFailure,ArgumentError:ArgumentError,DeclarationError:DeclarationError},window.classify=classify,window.exports&&(exports.classify=window.classify)})(this);